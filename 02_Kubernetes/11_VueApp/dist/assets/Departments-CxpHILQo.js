import{o as u,c as i,a as e,F as y,r as k,w as h,t as m,n as q,b as g,u as x,d as D,e as N,f as w,g as P}from"./index-C9GZoySm.js";import{a as f}from"./index-CcWmx0UX.js";const I={class:"table table-striped table-hover text-center"},L=e("thead",null,[e("tr",null,[e("th",null,"학과 번호"),e("th",null,"학과 이름"),e("th",null,"계열"),e("th",null,"개설 여부"),e("th",null,"정원"),e("th",null,"삭제")])],-1),R=["onClick"],B=["onClick"],M={__name:"DepartmentList",props:{departments:{type:Array,required:!0}},emits:["delete-department","item-click"],setup(c,{emit:d}){const r=d,p=n=>{confirm("정말로 삭제하시겠습니까?")&&r("delete-department",n)};return(n,a)=>(u(),i("div",null,[e("table",I,[L,e("tbody",null,[(u(!0),i(y,null,k(c.departments,t=>(u(),i("tr",{key:t.no,onClick:h(s=>r("item-click",t.no),["stop"])},[e("td",null,m(t.no),1),e("td",null,m(t.name),1),e("td",null,m(t.category),1),e("td",null,m(t.openYn),1),e("td",null,m(t.capacity),1),e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:h(s=>p(t.no),["stop"])},"삭제",8,B)])],8,R))),128))])])]))}},F={"aria-label":"Page navigation example"},S={class:"pagination justify-content-center"},V={class:"page-item"},j=e("span",{"aria-hidden":"true"},"«",-1),z=[j],A=["onClick"],E={class:"page-item"},O=e("span",{"aria-hidden":"true"},"»",-1),Y=[O],G={__name:"PageNation",props:{currentPage:{type:Number,required:!0},startPage:{type:Number,required:!0},endPage:{type:Number,required:!0}},emits:["change-page"],setup(c,{emit:d}){const r=d,p=(n,a)=>{let t=[];for(let s=n;s<=a;s++)t.push(s);return t};return(n,a)=>(u(),i("div",null,[e("nav",F,[e("ul",S,[e("li",V,[e("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:a[0]||(a[0]=h(t=>r("change-page",c.currentPage-1),["prevent"]))},z)]),(u(!0),i(y,null,k(p(c.startPage,c.endPage),t=>(u(),i("li",{key:t,class:"page-item"},[e("a",{class:q(["page-link",{active:c.currentPage===t}]),href:"#",onClick:h(s=>r("change-page",t),["prevent"])},m(t),11,A)]))),128)),e("li",E,[e("a",{class:"page-link",href:"#","aria-label":"Next",onClick:a[1]||(a[1]=h(t=>r("change-page",c.currentPage+1),["prevent"]))},Y)])])])]))}},H=e("h2",null,"학과 목록 조회",-1),v=5,J=10,T={__name:"Departments",setup(c){const d=g([]),r=x(),p=D(),n=g(parseInt(r.query.page)||1),a=g(0),t=g(0),s=g(0),_=async l=>{try{const o=await f.get(`/departments?page=${l}&numOfRows=10`);d.value=o.data.result,s.value=parseInt(Math.ceil(o.data.totalCount/J)),a.value=v*parseInt((l-1)/v)+1,t.value=a.value+v-1,t.value=t.value>s.value?s.value:t.value}catch(o){console.log(o)}},b=l=>{l>=1&&l<=s.value&&p.push({name:"departments",query:{page:l}})},C=async l=>{try{const o=await f.delete(`/departments/${l}`);o.data.code===200?(alert("정상적으로 삭제되었습니다."),_(n.value)):o.data.code===404?alert("존재하지 않는 학과입니다."):alert("학과 삭제를 실패했습니다.")}catch(o){console.log(o)}},$=l=>{p.push({name:"departments/no",params:{no:l}})};return N(()=>{_(n.value)}),w(r,()=>{n.value=parseInt(r.query.page)||1,_(n.value)}),(l,o)=>(u(),i("div",null,[H,P(M,{departments:d.value,onDeleteDepartment:C,onItemClick:$},null,8,["departments"]),P(G,{currentPage:n.value,startPage:a.value,endPage:t.value,onChangePage:b},null,8,["currentPage","startPage","endPage"])]))}};export{T as default};
